{
   "id": "ucs_system_config_netflow_monitoring#",
   "$schema": "http://json-schema.org/draft-07/schema#",
   "title": "EasyUCS ucs system config netflow_monitoring section",
   "description": "EasyUCS ucs system config netflow_monitoring section JSON schema",
   "type": "object",
   "properties": {
      "admin_state": {
         "description": "Admin state of Netflow Monitoring",
         "type": "string",
         "default": "disabled",
         "enum": [
            "disabled",
            "enabled"
         ]
      },
      "flow_record_definitions": {
         "description": "Flow record definitions of Netflow Monitoring",
         "type": "array",
         "items": {
            "description": "Flow record definition of Netflow Monitoring",
            "type": "object",
            "oneOf": [
               {
                  "properties": {
                     "name": {
                        "description": "Name of Flow record definition",
                        "type": "string",
                        "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
                     },
                     "descr": {
                        "description": "Description of Flow record definition",
                        "type": "string",
                        "pattern": "^[ !#$%&\\(\\)\\*\\+,\\-\\./:;\\?@\\[\\]_\\{\\|\\}~a-zA-Z0-9]{0,256}$"
                     },
                     "key_type": {
                        "description": "Key type of Flow record definition",
                        "type": "string",
                        "enum": [
                           "ipv4keys",
                           "ipv6keys",
                           "l2keys"
                        ]
                     },
                     "ipv4keys": {
                        "description": "IPv4 keys of Flow record definition",
                        "type": "array",
                        "items": {
                           "description": "IPv4 key of Flow record definition",
                           "type": "string",
                           "enum": [
                              "none",
                              "dest-port",
                              "ip-protocol",
                              "ip-tos",
                              "ipv4-dest-address",
                              "ipv4-src-address",
                              "src-port"
                           ]
                        },
                        "minItems": 1
                     },
                     "nonkeys": {
                        "description": "Non-keys of Flow record definition",
                        "type": "array",
                        "items": {
                           "description": "Non-key of Flow record definition",
                           "type": "string",
                           "enum": [
                              "none",
                              "counter-packets-long",
                              "counter-bytes-long",
                              "sys-uptime-first",
                              "sys-uptime-last"
                           ]
                        },
                        "minItems": 1
                     },
                     "record_type": {
                        "description": "Type of Flow record definition",
                        "type": "string"
                     }
                  },
                  "additionalProperties": false,
                  "required": [
                     "name"
                  ]
               },
               {
                  "properties": {
                     "name": {
                        "description": "Name of Flow record definition",
                        "type": "string",
                        "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
                     },
                     "descr": {
                        "description": "Description of Flow record definition",
                        "type": "string",
                        "pattern": "^[ !#$%&\\(\\)\\*\\+,\\-\\./:;\\?@\\[\\]_\\{\\|\\}~a-zA-Z0-9]{0,256}$"
                     },
                     "key_type": {
                        "description": "Key type of Flow record definition",
                        "type": "string",
                        "enum": [
                           "ipv4keys",
                           "ipv6keys",
                           "l2keys"
                        ]
                     },
                     "ipv6keys": {
                        "description": "IPv6 keys of Flow record definition",
                        "type": "array",
                        "items": {
                           "description": "IPv6 key of Flow record definition",
                           "type": "string",
                           "enum": [
                              "none",
                              "dest-port",
                              "ip-protocol",
                              "ipv6-dest-address",
                              "ipv6-src-address",
                              "src-port"
                           ]
                        },
                        "minItems": 1
                     },
                     "nonkeys": {
                        "description": "Non-keys of Flow record definition",
                        "type": "array",
                        "items": {
                           "description": "Non-key of Flow record definition",
                           "type": "string",
                           "enum": [
                              "none",
                              "counter-packets-long",
                              "counter-bytes-long",
                              "sys-uptime-first",
                              "sys-uptime-last"
                           ]
                        },
                        "minItems": 1
                     },
                     "record_type": {
                        "description": "Type of Flow record definition",
                        "type": "string"
                     }
                  },
                  "additionalProperties": false,
                  "required": [
                     "name"
                  ]
               },
               {
                  "properties": {
                     "name": {
                        "description": "Name of Flow record definition",
                        "type": "string",
                        "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
                     },
                     "descr": {
                        "description": "Description of Flow record definition",
                        "type": "string",
                        "pattern": "^[ !#$%&\\(\\)\\*\\+,\\-\\./:;\\?@\\[\\]_\\{\\|\\}~a-zA-Z0-9]{0,256}$"
                     },
                     "key_type": {
                        "description": "Key type of Flow record definition",
                        "type": "string",
                        "enum": [
                           "ipv4keys",
                           "ipv6keys",
                           "l2keys"
                        ]
                     },
                     "l2keys": {
                        "description": "L2 keys of Flow record definition",
                        "type": "array",
                        "items": {
                           "description": "L2 key of Flow record definition",
                           "type": "string",
                           "enum": [
                              "none",
                              "ethertype",
                              "dest-mac-address",
                              "src-mac-address"
                           ]
                        },
                        "minItems": 1
                     },
                     "nonkeys": {
                        "description": "Non-keys of Flow record definition",
                        "type": "array",
                        "items": {
                           "description": "Non-key of Flow record definition",
                           "type": "string",
                           "enum": [
                              "none",
                              "counter-packets-long",
                              "counter-bytes-long",
                              "sys-uptime-first",
                              "sys-uptime-last"
                           ]
                        },
                        "minItems": 1
                     },
                     "record_type": {
                        "description": "Type of Flow record definition",
                        "type": "string"
                     }
                  },
                  "additionalProperties": false,
                  "required": [
                     "name"
                  ]
               } 
            ]
         }
      },
      "flow_exporters": {
         "description": "Flow exporters of Netflow Monitoring",
         "type": "array",
         "items": {
            "description": "Flow exporter of Network Monitoring",
            "type": "object",
            "properties": {
               "name": {
                  "description": "Name of Flow exporter",
                  "type": "string",
                  "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
               },
               "descr": {
                  "description": "Description of Flow exporter",
                  "type": "string",
                  "pattern": "^[ !#$%&\\(\\)\\*\\+,\\-\\./:;\\?@\\[\\]_\\{\\|\\}~a-zA-Z0-9]{0,256}$"

               },
               "dscp": {
                  "description": "DSCP of Flow exporter",
                  "type": "string",
                  "default": "0",
                  "pattern": "^[0-9]$|^[1-5][0-9]$|^6[0-3]$"
               },
               "exporter_profile": {
                  "description": "Exporter profile of Flow exporter",
                  "type": "string"
               },
               "flow_collector": {
                  "description": "Flow collector of Flow exporter",
                  "type": "string"
               },
               "template_data_timeout": {
                  "description": "Template data timeout of Flow exporter",
                  "type": "string",
                  "pattern": "^([6-9][0-9]|[1-9][0-9]{2,3}|[1-7][0-9]{4}|8[0-5][0-9]{3}|86[0-3][0-9]{2}|86400)$"
               },
               "option_exporter_stats_timeout": {
                  "description": "Option exporter stats timeout of Flow exporter",
                  "type": "string",
                  "pattern": "^([6-9][0-9]|[1-9][0-9]{2,3}|[1-7][0-9]{4}|8[0-5][0-9]{3}|86[0-3][0-9]{2}|86400)$"
               },
               "option_interface_table_timeout": {
                  "description": "Option interface table timeout of Flow exporter",
                  "type": "string",
                  "pattern": "^([6-9][0-9]|[1-9][0-9]{2,3}|[1-7][0-9]{4}|8[0-5][0-9]{3}|86[0-3][0-9]{2}|86400)$"
               },
               "version": {
                  "description": "Version of Flow exporter",
                  "type": "string",
                  "enum": [
                     "ipfix",
                     "v9"
                  ]
               }
            },
            "additionalProperties": false,
            "required": [
               "name"
            ]
         }
      },
      "flow_collectors": {
         "description": "Flow collectors of Netflow Monitoring",
         "type": "array",
         "items": {
            "description": "Flow collector of Netflow Monitoring",
            "type": "object",
            "properties": {
               "name": {
                  "description": "Name of Flow collector",
                  "type": "string",
                  "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
               },
               "descr": {
                  "description": "Description of Flow collector",
                  "type": "string",
                  "pattern": "^[ !#$%&\\(\\)\\*\\+,\\-\\./:;\\?@\\[\\]_\\{\\|\\}~a-zA-Z0-9]{0,256}$"
               },
               "collector_ip": {
                  "description": "Collector IP of Flow collector",
                  "type": "string",
                  "format": "ipv4"
               },
               "port": {
                  "description": "Port of Flow collector",
                  "type": "string",
                  "pattern": "^([1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6([0-4][0-9]{3}|5([0-4][0-9]{2}|5([0-2][0-9]|3[0-5]))))$"
               },
               "exporter_gateway_ip": {
                  "description": "Exporter gateway ip of Flow collector",
                  "type": "string",
                  "format": "ipv4"
               },
               "vlan": {
                  "description": "VLAN of Flow collector",
                  "type": "string"
               }
            },
            "additionalProperties": false,
            "required": [
               "name"
            ]
         }
      },
      "flow_exporter_profiles": {
         "description": "Flow exporter profiles of Netflow Monitoring",
         "type": "array",
         "items": {
            "description": "Flow exporter profile of Netflow Monitoring",
            "type": "object",
            "properties": {
               "name": {
                  "description": "Name of Flow exporter profile",
                  "type": "string",
                  "const": "default"
               },
               "descr": {
                  "description": "Description of Flow exporter profile",
                  "type": "string",
                  "pattern": "^[ !#$%&\\(\\)\\*\\+,\\-\\./:;\\?@\\[\\]_\\{\\|\\}~a-zA-Z0-9]{0,256}$"
               },
               "exporter_interfaces": {
                  "description": "Exporter interfaces of Flow exporter profile",
                  "type": "array",
                  "items": {
                     "description": "Exporter Interface of Flow exporter profile",
                     "type": "object",
                     "properties": {
                        "vlan": {
                           "description": "VLAN of Exporter profile",
                           "type": "string",
                           "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,32}$"
                        },
                        "fabric_a": {
                           "type": "object",
                           "properties": {
                              "source_ip": {
                                 "description": "Source IP of Fabric A",
                                 "type": "string",
                                 "format": "ipv4"
                              },
                              "subnet_mask": {
                                 "description": "Subnet mask of Fabric A",
                                 "type": "string",
                                 "format": "ipv4"
                              }
                           },
                           "additionalProperties": false
                        },
                        "fabric_b": {
                           "type": "object",
                           "properties": {
                              "source_ip": {
                                 "description": "Source IP of Fabric B",
                                 "type": "string",
                                 "format": "ipv4"
                              },
                              "subnet_mask": {
                                 "description": "Subnet mask of Fabric B",
                                 "type": "string",
                                 "format": "ipv4"
                              }
                           },
                           "additionalProperties": false
                        }
                     },
                     "additionalProperties": false,
                     "required": [
                        "vlan"
                     ]
                  },
                  "maxItems": 2
               }
            }
         },
         "maxItems": 1
      },
      "flow_monitors": {
         "description": "Flow monitors of Netflow Monitoring",
         "type": "array",
         "items": {
            "description": "Flow monitor of Netflow Monitoring",
            "type": "object",
            "properties": {
               "name": {
                  "description": "Name of Flow monitor",
                  "type": "string",
                  "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
               },
               "descr": {
                  "description": "Description of Flow monitor",
                  "type": "string",
                  "pattern": "^[ !#$%&\\(\\)\\*\\+,\\-\\./:;\\?@\\[\\]_\\{\\|\\}~a-zA-Z0-9]{0,256}$"
               },
               "flow_definition": {
                  "description": "Flow record definition of Flow monitor",
                  "type": "string",
                  "pattern": "^[\\-\\.:_a-zA-Z0-9]{0,16}$"
               },
               "flow_exporters": {
                  "description": "Exporters of Flow monitor",
                  "type": "array",
                  "items": {
                     "type": "string",
                     "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
                  }
               },
               "flow_timeout_policy": {
                  "description": "Flow timeout policy of Flow monitor",
                  "type": "string",
                  "pattern": "^[\\-\\.:_a-zA-Z0-9]{0,16}$"
               }
            }
         }
      },
      "flow_timeout_policies": {
         "description": "Flow timeout policies of Netflow Monitoring",
         "type": "array",
         "items": {
            "description": "Flow timeout policy of Netflow Monitoring",
            "type": "object",
            "properties": {
               "name": {
                  "description": "Name of Flow timeout policy",
                  "type": "string",
                  "const": "default"
               },
               "descr": {
                  "description": "Description of Flow timeout policy",
                  "type": "string",
                  "pattern": "^[ !#$%&\\(\\)\\*\\+,\\-\\./:;\\?@\\[\\]_\\{\\|\\}~a-zA-Z0-9]{0,256}$"
               },
               "active_timeout": {
                  "description": "Active timeout of Flow timeout policy",
                  "type": "string",
                  "pattern": "^(6[0-9]|[7-9][0-9]|[1-9][0-9]{2}|[1-3][0-9]{3}|40[0-8][0-9]|409[0-2])$"
               },
               "inactive_timeout": {
                  "description": "Inactive timeout of Flow timeout policy",
                  "type": "string",
                  "pattern": "^(1[5-9]|[2-9][0-9]|[1-9][0-9]{2}|[1-3][0-9]{3}|40[0-8][0-9]|409[0-2])$"
               }
            }
         },
         "maxItems": 1
      },
      "flow_monitor_sessions": {
         "description": "Flow monitor sessions of Netflow Monitoring",
         "type": "array",
         "items": {
            "description": "Flow monitor session of Netflow Monitoring",
            "type": "object",
            "properties": {
               "name": {
                  "description": "Name of the Flow monitor session",
                  "type": "string",
                  "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
               },
               "descr": {
                  "description": "Description of the Flow monitor session",
                  "type": "string",
                  "pattern": "^[ !#$%&\\(\\)\\*\\+,\\-\\./:;\\?@\\[\\]_\\{\\|\\}~a-zA-Z0-9]{0,256}$"
               },
               "flow_monitors": {
                  "description": "Flow Monitors of the Flow monitor session",
                  "type": "array",
                  "items": {
                     "description": "Flow Monitor of the Flow monitor session",
                     "type": "object",
                     "properties": {
                        "name": {
                           "description": "Name of the Flow monitor",
                           "type": "string",
                           "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
                        },
                        "direction": {
                           "description": "Direction of the Flow monitor",
                           "type": "string",
                           "enum": [
                              "receive",
                              "transmit"
                           ]
                        }
                     },
                     "additionalProperties": false,
                     "required": [
                        "name",
                        "direction"
                     ]
                  }
               },
               "sources": {
                  "description": "Sources added to the Flow monitor session",
                  "type": "array",
                  "items": {
                     "description": "Source added to the Flow monitor session",
                     "type": "object",
                     "oneOf": [
                        {
                           "properties": {
                              "vnic": {
                                 "description": "Name of the Source vNIC",
                                 "type": "string",
                                 "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,16}$"
                              },
                              "source_type": {
                                 "description": "Type of the source added",
                                 "type": "string",
                                 "const": "vnic"
                              },
                              "service_profile": {
                                 "description": "Service profile name",
                                 "type": "string",
                                 "default": ""
                              },
                              "org": {
                                 "description": "Service profile org",
                                 "type": "string",
                                 "default": ""
                              }
                           },
                           "additionalProperties": false
                        },
                        {
                           "properties": {
                              "source_type": {
                                 "description": "Type of the source added",
                                 "type": "string",
                                 "const": "port-profile"
                              },
                              "port_profile": {
                                 "description": "Name of the Port Profile",
                                 "type": "string",
                                 "pattern": "^[\\-\\.:_a-zA-Z0-9]{1,31}$"
                              }
                           },
                           "additionalProperties": false
                        }
                     ]
                  },
                  "minItems": 0
               }
            },
            "additionalProperties": false,
            "required": [
               "name"
            ]
         }
      }
  },
   "additionalProperties": false,
   "required": [
      "admin_state"
   ]
}